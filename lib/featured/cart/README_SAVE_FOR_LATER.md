# Save For Later - ูุธุงู ุญูุธ ุงูููุชุฌุงุช ูุงุญูุงู

ุชู ุชุญุฏูุซ ูุธุงู "ุญูุธ ูุงุญูุงู" ููุนูู ูุน Supabase ุจุฏูุงู ูู Firestore.

## ุงููููุงุช ุงููุญุฏุซุฉ

### 1. **SaveForLaterRepository** (`lib/featured/cart/data/save_for_later_repository.dart`)
- **ุงูุบุฑุถ**: ุฅุฏุงุฑุฉ ุฌููุน ุนูููุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ููููุชุฌุงุช ุงููุญููุธุฉ
- **ุงูุทุฑู ุงูุฑุฆูุณูุฉ**:
  - `saveItem()` - ุญูุธ ููุชุฌ ูุงุญูุงู
  - `getSavedItems()` - ุฌูุจ ุงูููุชุฌุงุช ุงููุญููุธุฉ
  - `removeItem()` - ุญุฐู ููุชุฌ ูู ุงููุญููุธุงุช
  - `clearAllSavedItems()` - ูุณุญ ุฌููุน ุงููุญููุธุงุช
  - `isItemSaved()` - ุงูุชุญูู ูู ูุฌูุฏ ููุชุฌ ูู ุงููุญููุธุงุช
  - `moveToCart()` - ููู ููุชุฌ ูู ุงููุญููุธุงุช ููุณูุฉ
  - `moveAllToCart()` - ููู ุฌููุน ุงููุญููุธุงุช ููุณูุฉ

### 2. **SaveForLaterController** (`lib/featured/cart/controller/save_for_later.dart`)
- **ุชู ุฅุฒุงูุฉ**: ุฌููุน ุชุจุนูุงุช Firestore
- **ุชู ุฅุถุงูุฉ**: ุชูุงูู Supabase ูู ุฎูุงู ุงูู repository
- **ุชู ุชุญุฏูุซ**: ุฌููุน ุงูุทุฑู ูุชุตุจุญ async ูุน ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
- **ุชู ุฅุถุงูุฉ**: ุญุงูุงุช ุงูุชุญููู ูุฑุณุงุฆู ุงููุฌุงุญ/ุงูุฎุทุฃ

### 3. **Database Schema** (`lib/utils/supabase_save_for_later_schema.sql`)
- **ุงูุฌุฏูู**: `save_for_later`
- **ุงููููุฒุงุช**:
  - Row Level Security (RLS) ููุนู
  - ุชุญุฏูุซ ุชููุงุฆู ููุทูุงุจุน ุงูุฒูููุฉ
  - ููุงุฑุณ ููุฃุฏุงุก
  - ุฏูุงู ูุณุงุนุฏุฉ ููุนูููุงุช
  - ุนุฑุถ ููุฎุต ุงููุญููุธุงุช

## ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุงูุฎุทูุฉ 1: ุชุดุบูู SQL Schema
ูู ุจุชูููุฐ ุฃูุงูุฑ SQL ูู `lib/utils/supabase_save_for_later_schema.sql` ูู ูุญุฑุฑ SQL ุงูุฎุงุต ุจู Supabase:

```sql
-- ุงูุณุฎ ูุงูุตู ุงููุญุชูู ุงููุงูู ูู supabase_save_for_later_schema.sql
-- ูู ูุญุฑุฑ SQL ุงูุฎุงุต ุจู Supabase ููู ุจุชุดุบููู
```

### ุงูุฎุทูุฉ 2: ุงูุชุญูู ูู ุฅูุดุงุก ุงูุฌุฏูู
ุจุนุฏ ุชุดุบูู SQLุ ุชุฃูุฏ ูู ุฅูุดุงุก:
- โ ุฌุฏูู `save_for_later`
- โ ุณูุงุณุงุช RLS
- โ ุงูููุงุฑุณ
- โ ุงูุฏูุงู ุงููุณุงุนุฏุฉ
- โ ุนุฑุถ `saved_items_summary`

## ูููู ุงูุจูุงูุงุช

### ุฌุฏูู `save_for_later`:
```sql
CREATE TABLE save_for_later (
  id UUID PRIMARY KEY,
  user_id UUID REFERENCES auth.users(id),
  product_id TEXT NOT NULL,
  vendor_id TEXT,
  title TEXT NOT NULL,
  price DECIMAL(10,2),
  quantity INTEGER,
  image TEXT,
  total_price DECIMAL(10,2),
  created_at TIMESTAMP,
  updated_at TIMESTAMP,
  UNIQUE(user_id, product_id) -- ููุน ุชูุฑุงุฑ ุงูููุชุฌ ูููุณ ุงููุณุชุฎุฏู
);
```

## ุฃูุซูุฉ ุงูุงุณุชุฎุฏุงู

### ุญูุธ ููุชุฌ ูุงุญูุงู
```dart
final saveController = Get.find<SaveForLaterController>();
await saveController.saveItem(cartItem);
```

### ุฌูุจ ุงูููุชุฌุงุช ุงููุญููุธุฉ
```dart
await saveController.fetchSavedItems();
final savedItems = saveController.savedItems;
```

### ุญุฐู ููุชุฌ ูู ุงููุญููุธุงุช
```dart
await saveController.removeItem(productId);
```

### ููู ููุชุฌ ููุณูุฉ
```dart
await saveController.addToCart(cartItem);
```

### ููู ุฌููุน ุงููุญููุธุงุช ููุณูุฉ
```dart
await saveController.addAllToCart();
```

### ุงูุชุญูู ูู ูุฌูุฏ ููุชุฌ ูู ุงููุญููุธุงุช
```dart
final isSaved = await saveController.isItemSaved(productId);
```

### ุงูุญุตูู ุนูู ุนุฏุฏ ุงููุญููุธุงุช
```dart
final count = await saveController.getSavedItemsCount();
```

### ูุณุญ ุฌููุน ุงููุญููุธุงุช
```dart
await saveController.clearAllSavedItems();
```

## ุงููููุฒุงุช ุงูุฌุฏูุฏุฉ

### 1. **ุฃูุงู ุฃูุถู**
- Row Level Security ูุถูู ุฃู ุงููุณุชุฎุฏู ูุฑู ููุท ูุญููุธุงุชู
- ุญูุงูุฉ ุนูู ูุณุชูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### 2. **ุฃุฏุงุก ูุญุณู**
- ููุงุฑุณ ููุงุณุชุนูุงูุงุช ุงูุณุฑูุนุฉ
- ุนูููุงุช ูุงุนุฏุฉ ุจูุงูุงุช ูุญุณูุฉ

### 3. **ูุนุงูุฌุฉ ุฃุฎุทุงุก ุฃูุถู**
- ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ
- ุญุงูุงุช ุชุญููู ูููุณุชุฎุฏู

### 4. **ุชูุงูู ูุน ุงูุณูุฉ**
- ููู ุณูู ูู ุงููุญููุธุงุช ููุณูุฉ
- ุฏุนู ุงููููุงุช ุงููุชุนุฏุฏุฉ

## ุงุณุชุนูุงูุงุช ูููุฏุฉ

```sql
-- ุนุฑุถ ุฌููุน ุงููุญููุธุงุช ููุณุชุฎุฏู ูุนูู
SELECT * FROM save_for_later WHERE user_id = 'user-uuid';

-- ุญุณุงุจ ุฅุฌูุงูู ูููุฉ ุงููุญููุธุงุช
SELECT SUM(total_price) as total FROM save_for_later WHERE user_id = 'user-uuid';

-- ุนุฏุฏ ุงูููุชุฌุงุช ุงููุญููุธุฉ
SELECT COUNT(*) as count FROM save_for_later WHERE user_id = 'user-uuid';

-- ุญุฐู ุฌููุน ุงููุญููุธุงุช
DELETE FROM save_for_later WHERE user_id = 'user-uuid';

-- ููู ููุชุฌ ููุณูุฉ (ุฏุงูุฉ ูุฏูุฌุฉ)
SELECT move_saved_item_to_cart('user-uuid', 'product-id', 1);
```

## ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดุงูู ุงูุดุงุฆุนุฉ

1. **ุฃุฎุทุงุก RLS Policy**: ุชุฃูุฏ ูู ุฅุนุฏุงุฏ ุณูุงุณุงุช RLS ุจุดูู ุตุญูุญ
2. **ุฃุฎุทุงุก ุงููุตุงุฏูุฉ**: ุชุฃูุฏ ูู ุชุณุฌูู ุฏุฎูู ุงููุณุชุฎุฏู
3. **ุฃุฎุทุงุก ุงูููุน**: ุชุญูู ูู ุตุญุฉ ูุนุฑูุงุช ุงูููุชุฌุงุช
4. **ุฃุฎุทุงุก ุงูุดุจูุฉ**: ุชุนุงูู ูุน ูุดุงูู ุงูุงุชุตุงู ุจุดูู ููุงุณุจ

### ูุตุงุฆุญ ุงูุชุตุญูุญ

1. ุชุญูู ูู ุณุฌูุงุช Supabase ููุฃุฎุทุงุก
2. ุงุณุชุฎุฏู `debugPrint()` ูุชุชุจุน ุงูุนูููุงุช
3. ุชุญูู ูู ุญุงูุฉ ุงููุตุงุฏูุฉ
4. ุชุญูู ูู ุณูุงุณุงุช RLS ูู ููุญุฉ Supabase

## ุงูุชุญุณููุงุช ุงููุณุชูุจููุฉ

1. **ุชุญุฏูุซุงุช ููุฑูุฉ**: ูุฒุงููุฉ ููุฑูุฉ ูููุญููุธุงุช
2. **ุฅุดุนุงุฑุงุช**: ุชูุจููุงุช ููููุชุฌุงุช ุงููุญููุธุฉ
3. **ุชุตููู**: ุชุตููู ุงููุญููุธุงุช ุญุณุจ ุงููุฆุฉ
4. **ูุดุงุฑูุฉ**: ูุดุงุฑูุฉ ููุงุฆู ุงููุญููุธุงุช
5. **ุชุญูููุงุช**: ุฅุญุตุงุฆูุงุช ุงุณุชุฎุฏุงู ุงููุญููุธุงุช

## ูุงุฆูุฉ ุงูุชุญูู

- [x] ุฅูุดุงุก repository
- [x] ุชุญุฏูุซ controller
- [x] ุฅูุดุงุก schema ูุงุนุฏุฉ ุงูุจูุงูุงุช
- [x] ุฅุฒุงูุฉ ุชุจุนูุงุช Firestore
- [x] ุฅุตูุงุญ ุฃุฎุทุงุก linting
- [x] ุฅุถุงูุฉ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
- [x] ุฅุถุงูุฉ ุญุงูุงุช ุงูุชุญููู
- [x] ุงุฎุชุจุงุฑ ุงููุธุงุฆู

ุงููุธุงู ุฌุงูุฒ ููุงุณุชุฎุฏุงู! ๐ฏโจ
