# ููุฎุต ุชุญุฏูุซ VendorRepository ูุฏุนู ุฑูุงุจุท ุงูุณูุดุงู ููุฏูุง

## ุงูุชุญุฏูุซุงุช ุงูููุฌุฒุฉ โ

### 1. ุชุญุฏูุซ ุงูุฏูุงู ุงูุฃุณุงุณูุฉ
- โ `getVendorById()` - ูุณุชุฎุฏู ุงูุขู `vendors_with_social_links` view
- โ `getVendorByUserId()` - ูุณุชุฎุฏู ุงูุขู `vendors_with_social_links` view  
- โ `getAllActiveVendors()` - ูุณุชุฎุฏู ุงูุขู `vendors_with_social_links` view
- โ `searchVendors()` - ูุณุชุฎุฏู ุงูุขู `vendors_with_social_links` view
- โ `updateVendorProfile()` - ูุญูุธ ุฑูุงุจุท ุงูุณูุดุงู ููุฏูุง ุชููุงุฆูุงู

### 2. ุฏูุงู ุฌุฏูุฏุฉ ูุฎุตุตุฉ ูุฑูุงุจุท ุงูุณูุดุงู ููุฏูุง
- โ `updateVendorSocialLinks()` - ุญูุธ/ุชุญุฏูุซ ุฑูุงุจุท ุงูุณูุดุงู ููุฏูุง
- โ `getVendorSocialLinks()` - ุงูุญุตูู ุนูู ุฑูุงุจุท ุงูุณูุดุงู ููุฏูุง ููุท
- โ `_mapVendorWithSocialLinks()` - ูุนุงูุฌุฉ ุงูุจูุงูุงุช ูู ุงูู view

### 3. ูุนุงูุฌุฉ ุงูุจูุงูุงุช ุงููุญุณูุฉ
- โ ุฏุนู ูุงูู ูุฌููุน ุญููู ุงูุณูุดุงู ููุฏูุง
- โ ูุนุงูุฌุฉ ูุงุฆูุฉ ุงูููุงุชู (JSON array)
- โ ูุนุงูุฌุฉ ุญุงูุงุช ุงูุฅุธูุงุฑ (visibility)
- โ ูุนุงูุฌุฉ ุขููุฉ ููุจูุงูุงุช ุงูููููุฏุฉ

## ููููุฉ ุนูู ุงููุธุงู ุงูุฌุฏูุฏ

### 1. ุชุญููู ุงูุจูุงูุงุช
```dart
// ุนูุฏ ุชุญููู ุจูุงูุงุช ุงูุชุงุฌุฑ
final vendor = await repository.getVendorById(vendorId);
// ุงููุชูุฌุฉ: VendorModel ูุน socialLink ููููุก ุจุงูุจูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
```

### 2. ุญูุธ ุงูุจูุงูุงุช
```dart
// ุนูุฏ ุญูุธ ุชุญุฏูุซุงุช ุงูุชุงุฌุฑ
await repository.updateVendorProfile(vendorId, updatedVendor);
// ูุชู ุญูุธ:
// 1. ุจูุงูุงุช ุงูุชุงุฌุฑ ุงูุฃุณุงุณูุฉ ูู ุฌุฏูู vendors
// 2. ุฑูุงุจุท ุงูุณูุดุงู ููุฏูุง ูู ุฌุฏูู vendor_social_links
```

### 3. ุชุญุฏูุซ ุฑูุงุจุท ุงูุณูุดุงู ููุฏูุง ููุท
```dart
// ูุชุญุฏูุซ ุฑูุงุจุท ุงูุณูุดุงู ููุฏูุง ููุท
await repository.updateVendorSocialLinks(vendorId, socialLink);
// ูุชู ุญูุธ ุงูุจูุงูุงุช ูู ุฌุฏูู vendor_social_links
```

## ุจููุฉ ุงูุจูุงูุงุช

### View: vendors_with_social_links
```sql
-- ูุฌูุน ุจูุงูุงุช ุงูุชุงุฌุฑ ูุน ุฑูุงุจุท ุงูุณูุดุงู ููุฏูุง
SELECT 
    v.*,                    -- ุฌููุน ุจูุงูุงุช ุงูุชุงุฌุฑ
    vsl.facebook,           -- ุฑูุงุจุท ุงูุณูุดุงู ููุฏูุง
    vsl.instagram,
    vsl.whatsapp,
    vsl.phones,             -- ูุงุฆูุฉ ุงูููุงุชู
    vsl.visible_facebook,   -- ุญุงูุงุช ุงูุฅุธูุงุฑ
    vsl.visible_instagram,
    -- ... ุจุงูู ุงูุญููู
FROM vendors v
LEFT JOIN vendor_social_links vsl ON v.id = vsl.vendor_id;
```

### ุฌุฏูู: vendor_social_links
```sql
-- ูุญุชูู ุนูู ุฑูุงุจุท ุงูุณูุดุงู ููุฏูุง ููู ุชุงุฌุฑ
CREATE TABLE vendor_social_links (
    id UUID PRIMARY KEY,
    vendor_id UUID REFERENCES vendors(id),
    facebook TEXT,
    instagram TEXT,
    whatsapp TEXT,
    phones JSONB DEFAULT '[]',
    visible_facebook BOOLEAN DEFAULT true,
    -- ... ุจุงูู ุงูุญููู
);
```

## ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ

### 1. ุฏุนู Insert/Update ุงูุชููุงุฆู
- ุฅุฐุง ูู ุชูู ููุงู ุฑูุงุจุท ุณูุดุงู ููุฏูุง ููุชุงุฌุฑุ ูุชู ุฅูุดุงุก ุณุฌู ุฌุฏูุฏ
- ุฅุฐุง ูุงูุช ููุฌูุฏุฉุ ูุชู ุชุญุฏูุซ ุงูุณุฌู ุงูููุฌูุฏ

### 2. ูุนุงูุฌุฉ ุขููุฉ ููุจูุงูุงุช
- ูุนุงูุฌุฉ ุขููุฉ ููุจูุงูุงุช ุงูููููุฏุฉ (null values)
- ููู ุงูุชุฑุงุถูุฉ ููุงุณุจุฉ ููู ุญูู
- fallback ุฅูู VendorModel.fromJson ูู ุญุงูุฉ ุงูุฎุทุฃ

### 3. ุฃุฏุงุก ูุญุณู
- ุงุณุชุฎุฏุงู ุงูู view ูุฏูุฌ ุงูุจูุงูุงุช ูู ุงุณุชุนูุงู ูุงุญุฏ
- ุชุฌูุจ ุงูุงุณุชุนูุงูุงุช ุงููุชุนุฏุฏุฉ
- ููุงุฑุณ ูุญุณูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

## ูุซุงู ุนูู ุงูุงุณุชุฎุฏุงู

### ูู VendorController
```dart
// ุชุญุฏูุซ ุฑุงุจุท ููุณุจูู
controller.updateSocialLink('facebook', 'https://facebook.com/username');

// ุญูุธ ุงูุชุบููุฑุงุช
await controller.saveVendorUpdates(vendorId);
// ุณูุชู ุญูุธ ุฑูุงุจุท ุงูุณูุดุงู ููุฏูุง ุชููุงุฆูุงู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
```

### ูู ุงููุงุฌูุฉ
```dart
// ุนุฑุถ ุฑูุงุจุท ุงูุณูุดุงู ููุฏูุง
final vendor = controller.profileData.value;
final socialLink = vendor.socialLink;

if (socialLink.visibleFacebook && socialLink.facebook.isNotEmpty) {
  // ุนุฑุถ ุฑุงุจุท ุงูููุณุจูู
  Text(socialLink.facebook);
}
```

## ุงูุงุฎุชุจุงุฑ

### ููุชุญูู ูู ุนูู ุงููุธุงู:
1. **ุชุญููู ุงูุจูุงูุงุช**: ุชุฃูุฏ ูู ุชุญููู ุฑูุงุจุท ุงูุณูุดุงู ููุฏูุง ุนูุฏ ูุชุญ ุตูุญุฉ ุฅุนุฏุงุฏุงุช ุงููุชุฌุฑ
2. **ุญูุธ ุงูุจูุงูุงุช**: ุฌุฑุจ ุฅุถุงูุฉ/ุชุนุฏูู ุฑูุงุจุท ุงูุณูุดุงู ููุฏูุง ูุญูุธูุง
3. **ุนุฑุถ ุงูุจูุงูุงุช**: ุชุฃูุฏ ูู ุธููุฑ ุงูุฑูุงุจุท ูู ุตูุญุฉ ุงููุชุฌุฑ ุญุณุจ ุฅุนุฏุงุฏุงุช ุงูุฅุธูุงุฑ
4. **ุงูุจุญุซ**: ุฌุฑุจ ุงูุจุญุซ ูู ุงูุชุฌุงุฑ ูุชุฃูุฏ ูู ุชุญููู ุฑูุงุจุท ุงูุณูุดุงู ููุฏูุง

## ุงูุฃูุงู
- โ RLS policies ูุทุจูุฉ ุนูู ุฌุฏูู vendor_social_links
- โ ุงูุชุงุฌุฑ ููููู ุงููุตูู ูุจูุงูุงุชู ููุท
- โ ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช ูุจู ุงูุญูุธ

---

**ุงููุธุงู ุฌุงูุฒ ููุงุณุชุฎุฏุงู!** ๐

ุฌููุน ุงูุชุญุฏูุซุงุช ุชูุช ุจูุฌุงุญ ููุง ุชูุฌุฏ ุฃุฎุทุงุก ูู ุงูููุฏ. ูููู ุงูุขู ุงุณุชุฎุฏุงู ุงููุธุงู ุงููุงูู ูุฅุฏุงุฑุฉ ุฑูุงุจุท ุงูุณูุดุงู ููุฏูุง ููุชุฌุงุฑ.
